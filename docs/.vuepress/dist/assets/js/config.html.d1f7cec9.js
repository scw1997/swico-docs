"use strict";(self.webpackChunksecywo_docs=self.webpackChunksecywo_docs||[]).push([[314],{352:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>v,data:()=>m});var e=a(641);const t=(0,e.Fv)('<h1 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h1><p>secywo提供配置文件方便开发者可对部分项目配置进行修改扩展，例如Alias映射，本地请求代理等。</p><p>配置文件存在于项目根目录的<code>config</code>文件夹下，可包含以下三种文件：</p><ul><li><code>secywo.ts</code> ：通用公共配置。</li><li><code>secywo.dev.ts</code>： 开发环境专属配置，若与 <code>secywo.ts</code> 存在配置项冲突，以当前配置项为准。</li><li><code>secywo.prod.ts</code>： 生产环境专属配置，若与 <code>secywo.ts</code> 存在配置项冲突，以当前配置项为准。</li></ul><p>配置代码示例：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="config/secywo.ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>\n    alias<span class="token operator">:</span> <span class="token punctuation">{</span>\n        apiPath<span class="token operator">:</span> <span class="token string">&#39;src/api&#39;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    define<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token constant">FOO</span><span class="token operator">:</span> <span class="token string">&#39;foo&#39;</span>\n    <span class="token punctuation">}</span>\n  \n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="config/secywo.dev.ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>\n    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;/api/report&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            target<span class="token operator">:</span> <span class="token string">&#39;http://localhost:4000&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 跨域目标主机，自行修改</span>\n            ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代理 websockets</span>\n            changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n            pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>\n                <span class="token string-property property">&#39;^/api&#39;</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// 重写地址</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="config/secywo.prod.ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>\n    <span class="token comment">//插件</span>\n    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token comment">//优化moment包体积，构建时忽略外国语言包</span>\n        <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token function">ContextReplacementPlugin</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moment[/\\\\]locale$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">zh-cn</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token builtin">console</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//生产环境保留console</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>💡 我们推荐你使用模板内置包<code>secywo-template-cli</code>提供的<code>defineConfig</code>方法来自定义配置，以便支持ts类型提示：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="config/secywo.dev.ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;secywo-template-cli&#39;</span><span class="token punctuation">;</span>\n\n<span class="token comment">//第一个参数指定环境，可选值有base,dev,prod</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token string">&#39;dev&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;/api/report&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            target<span class="token operator">:</span> <span class="token string">&#39;http://localhost:4000&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 跨域目标主机，自行修改</span>\n            ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代理 websockets</span>\n            changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n            pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>\n                <span class="token string-property property">&#39;^/api&#39;</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// 重写地址</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是可用配置项的介绍：</p><h2 id="alias" tabindex="-1"><a class="header-anchor" href="#alias"><span>alias</span></a></h2><p>配置导入别名，对 import 语句的 source 做映射。</p><p>例如：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>alias<span class="token operator">:</span> <span class="token punctuation">{</span>\n    apiPath<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;/src/api&#39;</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>则你在项目代码中使用<code>import &#39;apiPath/test&#39; </code>等价于引入<code>项目根路径/scr/api/test</code>。</p><p>配置此项后，你需要在<code>tsconfig.json &gt; compilerOptions &gt; paths </code>属性中添加声明，以支持 ts 类型提示。</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="tsconfig.json"><pre class="language-typescript"><code><span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token comment">//...</span>\n            <span class="token string-property property">&quot;apiPath/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/api/*&quot;</span><span class="token punctuation">]</span>\n            <span class="token comment">//...</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>secywo默认已配置<code>@</code>映射为<code>/src</code>路径</p></blockquote><blockquote><p>此配置项仅<code>secywo.ts</code>可用</p></blockquote><h2 id="console" tabindex="-1"><a class="header-anchor" href="#console"><span>console</span></a></h2><p>默认值：<code>true</code></p><p>生产环境是否在浏览器控制台中显示代码中console 打印的信息。</p><blockquote><p>此配置项仅<code>secywo.prod.ts</code>可用</p></blockquote><h2 id="copy" tabindex="-1"><a class="header-anchor" href="#copy"><span>copy</span></a></h2><p>打包构建时将指定目录文件（夹）复制到指定路径。</p><p>当值为<code>字符串数组</code>时，默认拷贝到产物dist目录，如：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>copy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;foo.json&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;src/bar.json&#39;</span><span class="token punctuation">]</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>会产生如下产物的结构：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>+ dist\n  - bar.json\n  - foo.json\n+ src\n  - bar.json\n- foo.json\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当值为<code>对象数组</code>时，支持复制到指定目标路径。 其中相对路径默认为项目根目录，不支持根路径写法。</p><p>比如：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>copy<span class="token operator">:</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span> from<span class="token operator">:</span> <span class="token string">&#39;from&#39;</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">&#39;dist/output&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> from<span class="token operator">:</span> <span class="token string">&#39;file.json&#39;</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">&#39;dist&#39;</span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时将产生如下产物结构：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>+ dist\n  + output\n    - foo.json\n  - file.json\n+ from\n  - foo.json\n- file.json\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>secywo默认已内置在构建产物时对项目根路径下public文件夹复制到构建产物dist目录下</p></blockquote><blockquote><p>此配置项仅<code>secywo.prod.ts</code>可用</p></blockquote><h2 id="define" tabindex="-1"><a class="header-anchor" href="#define"><span>define</span></a></h2><p>设置项目开发代码中可全局访问的变量值。</p><p>例如：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>define<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">FOO</span><span class="token operator">:</span> <span class="token string">&#39;bar&#39;</span> <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>那么代码里的 <code>console.log(hello, FOO)</code> 会被编译成 <code>console.log(hello, &#39;bar&#39;)</code>。</p><p>同时也支持通过函数返回一个对象或promise来设置变量值：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token function-variable function">define</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token constant">FOO</span><span class="token operator">:</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//或者</span>\n<span class="token function-variable function">define</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span>resolve <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token constant">FOO</span><span class="token operator">:</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此外，你需要在<code>typings</code>文件夹中或其他类型声明文件中声明已设置的变量类型，以支持 ts 类型检查和提示：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="typings/global.d.ts"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FOO</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>⚠️ 注意：设置的每个变量值会进行一次JSON.stringify转换。如果你设置的变量值为引用类型，请记得取值时进行类型转换</p></blockquote><blockquote><p>此配置项仅<code>secywo.ts</code>可用</p></blockquote><h2 id="devtool" tabindex="-1"><a class="header-anchor" href="#devtool"><span>devtool</span></a></h2><ul><li><p>默认值：</p><p>开发环境：<code>cheap-module-source-map</code>（Vue模板），<code>eval-cheap-module-source-map</code>（React模板）</p><p>生产环境：<code>nosources-source-map</code></p></li></ul><p>devtool用于设置SourceMap源码映射类型，主要用于代码运行报错时的错误定位排查。</p>',51),p={href:"https://webpack.docschina.org/configuration/devtool/",target:"_blank",rel:"noopener noreferrer"},o=(0,e.Fv)('<h2 id="plugins" tabindex="-1"><a class="header-anchor" href="#plugins"><span>plugins</span></a></h2><p>默认值：<code>[]</code></p><p>Webpack Plugin 的相关配置，用于根据业务需要额外的一些 plugin 设置。</p><p>示例：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">//优化moment包体积，构建时忽略外国语言包</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token function">ContextReplacementPlugin</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moment[/\\\\]locale$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">zh-cn</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">]</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="proxy" tabindex="-1"><a class="header-anchor" href="#proxy"><span>proxy</span></a></h2><p>配置本地开发时，Webpack DevServer的请求代理。</p><p>示例：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>proxy<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token string-property property">&#39;/api/report&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        target<span class="token operator">:</span> <span class="token string">&#39;http://localhost:4000&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 跨域目标主机，自行修改</span>\n        ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代理 websockets</span>\n        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token string-property property">&#39;^/api&#39;</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// 重写地址</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',9),c={href:"https://webpack.docschina.org/configuration/dev-server/#devserverproxy",target:"_blank",rel:"noopener noreferrer"},l=(0,e.Fv)('<blockquote><p>此配置项仅<code>secywo.dev.ts</code>可用</p></blockquote><h2 id="publicpath" tabindex="-1"><a class="header-anchor" href="#publicpath"><span>publicPath</span></a></h2><p>默认值：<code>/</code></p><p>配置 Webpack 的<code>output &gt; publicPath</code> 选项，表示当前项目访问地址的前缀路径。</p><p>通常在当项目被部署到到服务器<code>非根路径</code>下的情况下使用。 比如项目被部署的服务器路径为<code>/test</code>，那么通过浏览器访问项目首页的地址默认为<code>www.xxx.com/test/index.html</code>。当不设置publicPath时， 项目构建后index.html中所引用的js，css，图片等静态资源地址依然是基于根路径，这种情况下访问上面首页地址后，将无法正确引用静态资源。 此时需要设置publicPath为<code>/test/</code>。</p>',5),i={href:"https://webpack.docschina.org/configuration/output/#outputpublicpath",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Lk)("code",null,"window.publicPath",-1),d=(0,e.Lk)("blockquote",null,[(0,e.Lk)("p",null,[(0,e.eW)("此配置项仅"),(0,e.Lk)("code",null,"secywo.ts"),(0,e.eW)("可用")])],-1),u=(0,e.Lk)("div",{class:"custom-container warning"},[(0,e.Lk)("p",{class:"custom-container-title"},"注意"),(0,e.Lk)("p",null,[(0,e.eW)("当配置此项后，通常前端路由也需要同步调整修改，例如"),(0,e.Lk)("code",null,"React-Router"),(0,e.eW)("的"),(0,e.Lk)("code",null,"basename"),(0,e.eW)("选项。")])],-1),k={},v=(0,a(262).A)(k,[["render",function(n,s){const a=(0,e.g2)("ExternalLinkIcon"),k=(0,e.g2)("RouteLink");return(0,e.uX)(),(0,e.CE)("div",null,[t,(0,e.Lk)("p",null,[(0,e.eW)("更多可选值说明参考 "),(0,e.Lk)("a",p,[(0,e.eW)("devtool文档"),(0,e.bF)(a)]),(0,e.eW)("。")]),o,(0,e.Lk)("p",null,[(0,e.eW)("更多属性说明请参考"),(0,e.Lk)("a",c,[(0,e.eW)("devServer Proxy文档"),(0,e.bF)(a)]),(0,e.eW)("。")]),l,(0,e.Lk)("p",null,[(0,e.eW)("更多细节参考 "),(0,e.Lk)("a",i,[(0,e.eW)("publicPath说明"),(0,e.bF)(a)]),(0,e.eW)("。")]),(0,e.Lk)("blockquote",null,[(0,e.Lk)("p",null,[(0,e.eW)("💡 secywo默认会将此属性值通过项目入口文件 "),(0,e.bF)(k,{to:"/template.html#index-ejs"},{default:(0,e.k6)((()=>[(0,e.eW)("index.ejs")])),_:1}),(0,e.eW)(" 挂载到全局，项目代码中可通过"),r,(0,e.eW)("访问。")])]),d,u])}]]),m=JSON.parse('{"path":"/config.html","title":"配置","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"alias","slug":"alias","link":"#alias","children":[]},{"level":2,"title":"console","slug":"console","link":"#console","children":[]},{"level":2,"title":"copy","slug":"copy","link":"#copy","children":[]},{"level":2,"title":"define","slug":"define","link":"#define","children":[]},{"level":2,"title":"devtool","slug":"devtool","link":"#devtool","children":[]},{"level":2,"title":"plugins","slug":"plugins","link":"#plugins","children":[]},{"level":2,"title":"proxy","slug":"proxy","link":"#proxy","children":[]},{"level":2,"title":"publicPath","slug":"publicpath","link":"#publicpath","children":[]}],"git":{"updatedTime":1708837129000},"filePathRelative":"config.md"}')}}]);